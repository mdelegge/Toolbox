<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Timer</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <meta name="color-scheme" content="dark light" />
  <style>
    :root { --progress: 0; }

    /* Hourglass outline using triangles */
    .hourglass {
      position: relative;
      width: 10rem;  /* 160px */
      height: 16rem; /* 256px */
    }
    .hourglass::before,
    .hourglass::after {
      content: "";
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      width: 0; height: 0;
      border-left: 5rem solid transparent;   /* 80px */
      border-right: 5rem solid transparent;  /* 80px */
      filter: drop-shadow(0 0 0 rgba(203,213,225,0.35));
    }
    .hourglass::before {
      top: 0;
      border-top: 8rem solid rgba(203,213,225,0.35);
    }
    .hourglass::after {
      bottom: 0;
      border-bottom: 8rem solid rgba(203,213,225,0.35);
    }

    /* Sand areas */
    .hg-top, .hg-bottom {
      position: absolute; 
      left: 0; right: 0;
      height: 50%;
      overflow: hidden;
    }
    .hg-top { top: 0; }
    .hg-bottom { bottom: 0; }

    .sand-top, .sand-bottom {
      position: absolute;
      left: 0; right: 0;
      height: 100%;
      background: linear-gradient(to bottom, rgba(251,191,36,0.95), rgba(245,158,11,0.95));
      will-change: transform;
      transition: transform 1s linear; /* smooth per-second updates */
    }

    /* Inverted triangle for top */
    .sand-top {
      top: 0;
      clip-path: polygon(0% 0%, 100% 0%, 50% 100%);
      transform-origin: bottom center;
      transform: scale(calc(1 - var(--progress)));
    }

    /* Upright triangle for bottom */
    .sand-bottom {
      bottom: 0;
      clip-path: polygon(50% 0%, 100% 100%, 0% 100%);
      transform-origin: bottom center;
      transform: scaleY(var(--progress));
    }

    /* Falling stream visible only while running */
    .stream {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -10%);
      width: 4px;
      height: 8rem;
      background: linear-gradient(to bottom, rgba(251,191,36,0.0), rgba(251,191,36,0.95) 30%, rgba(251,191,36,0.0));
      border-radius: 9999px;
      opacity: 0;
      pointer-events: none;
      transition: opacity 150ms ease-out;
      animation: shimmer 0.6s linear infinite;
      transform-origin: top center;
    }
    .stream.show { 
      opacity: 1;
      animation: shimmer 0.6s linear infinite, streamGrow 1s ease-out;
    }
    @keyframes shimmer {
      0% { filter: blur(0px); }
      50% { filter: blur(0.4px); }
      100% { filter: blur(0px); }
    }
    @keyframes streamGrow {
      0% { 
        transform: translate(-50%, -10%) scaleY(0.02);
      }
      100% { 
        transform: translate(-50%, -10%) scaleY(1);
      }
    }

    /* Finish flash overlay */
    #flashOverlay { display: none; }
    #flashOverlay.show {
      display: block;
      position: fixed; inset: 0;
      background: rgba(239,68,68,0.9);
      animation: flashOut 900ms ease-out forwards;
      z-index: 50;
      pointer-events: none;
    }
    @keyframes flashOut {
      0% { opacity: 0; }
      10% { opacity: 1; }
      100% { opacity: 0; }
    }
  </style>
</head>
<body class="bg-slate-900 text-slate-100 min-h-screen">
  <div id="flashOverlay"></div>

  <header class="border-b border-slate-800">
    <div class="max-w-3xl mx-auto px-4 py-6 flex items-center justify-between gap-3">
      <h1 class="text-2xl font-bold tracking-tight flex items-center gap-2"><span class="text-2xl">‚è≥</span> Timer</h1>
      <a href="../index.html" class="text-sm px-3 py-2 rounded bg-slate-800 hover:bg-slate-700 border border-slate-700">Back</a>
    </div>
  </header>

  <main class="max-w-3xl mx-auto px-4 py-8">
    <section class="p-6 bg-slate-800/60 rounded-2xl border border-slate-700">
      <!-- Inputs and controls -->
      <div class="grid gap-6 md:grid-cols-3">
        <div class="space-y-3 md:col-span-2">
          <div>
            <label class="block text-sm font-semibold mb-2 text-slate-300">Set Time (max 1 hour)</label>
            <div class="flex items-center gap-3">
              <div class="flex items-center gap-2">
                <input id="minutesInput" type="number" min="0" max="60" value="5" class="w-24 bg-slate-900 border border-slate-700 rounded-lg px-3 py-2" />
                <span class="text-slate-400 text-sm">min</span>
              </div>
              <div class="flex items-center gap-2">
                <input id="secondsInput" type="number" min="0" max="59" value="0" class="w-24 bg-slate-900 border border-slate-700 rounded-lg px-3 py-2" />
                <span class="text-slate-400 text-sm">sec</span>
              </div>
            </div>
          </div>

          <div class="flex flex-wrap items-center gap-3">
            <button id="startBtn" class="px-4 py-2 rounded-lg bg-emerald-600 hover:bg-emerald-500 font-medium">Start</button>
            <button id="stopBtn" class="px-4 py-2 rounded-lg bg-yellow-600/90 hover:bg-yellow-600 font-medium">Stop</button>
            <button id="resetBtn" class="px-4 py-2 rounded-lg bg-slate-800 hover:bg-slate-700 border border-slate-700">Reset</button>
          </div>
        </div>

        <div class="md:col-span-1 flex items-center justify-center">
          <div class="text-center">
            <div class="text-sm text-slate-400">Time Remaining</div>
            <div id="timeDisplay" class="text-4xl font-bold tracking-tight tabular-nums">05:00.00</div>
          </div>
        </div>

        <div class="md:col-span-3">
          <div class="flex items-center justify-center py-4">

            
            <div class="hourglass">
              
              <div class="hg-top">
                <div class="sand-top"></div>
              </div>
              
              <div class="hg-bottom">
                <div class="sand-bottom"></div>
              </div>

              <div id="stream" class="stream"></div>

              
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- DEBUG: Progress Value Display -->
  <!-- <div class="max-w-3xl mx-auto px-4 py-4">
    <div class="p-4 bg-slate-800/40 rounded-lg border border-slate-700/50 font-mono text-sm">
      <span class="text-slate-400">Debug Progress:</span>
      <span id="debugProgress" class="text-amber-400 ml-2">0</span>
    </div>
  </div> -->
  <!-- END DEBUG -->

  <script type="module" src="js/app.js"></script>
</body>
</html>
